2024-06-27 01:29:37.261 +04:00 [INF] Now listening on: https://localhost:7172
2024-06-27 01:29:37.300 +04:00 [INF] Now listening on: http://localhost:5241
2024-06-27 01:29:37.305 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-27 01:29:37.306 +04:00 [INF] Hosting environment: Development
2024-06-27 01:29:37.308 +04:00 [INF] Content root path: C:\Users\user\Desktop\For Programing Education\BACKEND\API\StructureApp\App\App\
2024-06-27 01:29:37.782 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/swagger/index.html - -
2024-06-27 01:29:38.126 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/swagger/index.html - - - 200 - text/html;charset=utf-8 350.4435ms
2024-06-27 01:29:38.153 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/_framework/aspnetcore-browser-refresh.js - -
2024-06-27 01:29:38.153 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/_vs/browserLink - -
2024-06-27 01:29:38.158 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/_framework/aspnetcore-browser-refresh.js - - - 200 12338 application/javascript;+charset=utf-8 5.0282ms
2024-06-27 01:29:38.210 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 56.4684ms
2024-06-27 01:29:38.298 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/swagger/v1/swagger.json - -
2024-06-27 01:29:38.397 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 99.1872ms
2024-06-27 01:29:50.501 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/api/admin/City/GetAll - -
2024-06-27 01:29:50.509 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.GetAll (App)'
2024-06-27 01:29:50.537 +04:00 [INF] Route matched with {action = "GetAll", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:29:51.290 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:29:51.880 +04:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CountryId], [c].[CreatedData], [c].[Name], [c].[Population], [c].[SoftDelete]
FROM [Cities] AS [c]
2024-06-27 01:29:51.934 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Service.DTOs.Admin.Cities.CityDto, Service, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-27 01:29:51.959 +04:00 [INF] Executed action App.Controllers.Admin.CityController.GetAll (App) in 1412.1141ms
2024-06-27 01:29:51.962 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.GetAll (App)'
2024-06-27 01:29:51.967 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/api/admin/City/GetAll - - - 200 - application/json;+charset=utf-8 1466.5880ms
2024-06-27 01:30:15.924 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/api/admin/City/GetByName/name/фцвцвфвц - -
2024-06-27 01:30:15.928 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.GetByName (App)'
2024-06-27 01:30:15.942 +04:00 [INF] Route matched with {action = "GetByName", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByName(System.String) on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:30:15.990 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:30:16.122 +04:00 [INF] Executed DbCommand (25ms) [Parameters=[@__name_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[CountryId], [c].[CreatedData], [c].[Name], [c].[Population], [c].[SoftDelete]
FROM [Cities] AS [c]
WHERE [c].[Name] = @__name_0
2024-06-27 01:30:16.129 +04:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-06-27 01:30:16.135 +04:00 [INF] Executed action App.Controllers.Admin.CityController.GetByName (App) in 191.1183ms
2024-06-27 01:30:16.139 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.GetByName (App)'
2024-06-27 01:30:16.142 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/api/admin/City/GetByName/name/фцвцвфвц - - - 500 - application/json;+charset=utf-8 217.8931ms
2024-06-27 01:44:17.762 +04:00 [INF] Now listening on: https://localhost:7172
2024-06-27 01:44:17.805 +04:00 [INF] Now listening on: http://localhost:5241
2024-06-27 01:44:17.813 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-27 01:44:17.814 +04:00 [INF] Hosting environment: Development
2024-06-27 01:44:17.815 +04:00 [INF] Content root path: C:\Users\user\Desktop\For Programing Education\BACKEND\API\StructureApp\App\App\
2024-06-27 01:44:18.156 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/swagger/index.html - -
2024-06-27 01:44:18.463 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/swagger/index.html - - - 200 - text/html;charset=utf-8 314.6935ms
2024-06-27 01:44:18.497 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/_vs/browserLink - -
2024-06-27 01:44:18.497 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/_framework/aspnetcore-browser-refresh.js - -
2024-06-27 01:44:18.508 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/_framework/aspnetcore-browser-refresh.js - - - 200 12338 application/javascript;+charset=utf-8 10.8130ms
2024-06-27 01:44:18.572 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 74.3442ms
2024-06-27 01:44:18.803 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/swagger/v1/swagger.json - -
2024-06-27 01:44:18.902 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 99.0859ms
2024-06-27 01:45:19.158 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7172/api/admin/City/GetById/22222222 - -
2024-06-27 01:45:19.169 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.GetById (App)'
2024-06-27 01:45:19.221 +04:00 [INF] Route matched with {action = "GetById", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:45:20.168 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:45:20.865 +04:00 [INF] Executed DbCommand (50ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[CountryId], [c].[CreatedData], [c].[Name], [c].[Population], [c].[SoftDelete]
FROM [Cities] AS [c]
WHERE [c].[Id] = @__id_0
2024-06-27 01:45:20.897 +04:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-06-27 01:45:20.924 +04:00 [INF] Executed action App.Controllers.Admin.CityController.GetById (App) in 1695.6164ms
2024-06-27 01:45:20.927 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.GetById (App)'
2024-06-27 01:45:20.934 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7172/api/admin/City/GetById/22222222 - - - 500 - application/json;+charset=utf-8 1775.6463ms
2024-06-27 01:45:36.617 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7172/api/admin/City/Create application/json 59
2024-06-27 01:45:36.620 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.Create (App)'
2024-06-27 01:45:36.626 +04:00 [INF] Route matched with {action = "Create", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Service.DTOs.Admin.Cities.CityCreateDto) on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:45:36.676 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:45:36.918 +04:00 [ERR] Failed executing DbCommand (12ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cities] ([CountryId], [CreatedData], [Name], [Population], [SoftDelete])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Cities]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2024-06-27 01:45:36.952 +04:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Cities_Countries_CountryId". The conflict occurred in database "AppBP101HomeTaskDb", table "dbo.Countries", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__189_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d25069bb-40f8-4853-b992-979acde6dd37
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Cities_Countries_CountryId". The conflict occurred in database "AppBP101HomeTaskDb", table "dbo.Countries", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__189_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d25069bb-40f8-4853-b992-979acde6dd37
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-27 01:45:36.984 +04:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-06-27 01:45:36.987 +04:00 [INF] Executed action App.Controllers.Admin.CityController.Create (App) in 357.7965ms
2024-06-27 01:45:36.988 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.Create (App)'
2024-06-27 01:45:36.990 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7172/api/admin/City/Create application/json 59 - 500 - application/json;+charset=utf-8 373.1956ms
2024-06-27 01:45:48.893 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7172/api/admin/City/Create application/json 59
2024-06-27 01:45:48.895 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.Create (App)'
2024-06-27 01:45:48.896 +04:00 [INF] Route matched with {action = "Create", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Service.DTOs.Admin.Cities.CityCreateDto) on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:45:48.914 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:45:48.921 +04:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cities] ([CountryId], [CreatedData], [Name], [Population], [SoftDelete])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Cities]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2024-06-27 01:45:48.925 +04:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Cities_Countries_CountryId". The conflict occurred in database "AppBP101HomeTaskDb", table "dbo.Countries", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__189_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d25069bb-40f8-4853-b992-979acde6dd37
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Cities_Countries_CountryId". The conflict occurred in database "AppBP101HomeTaskDb", table "dbo.Countries", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__189_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d25069bb-40f8-4853-b992-979acde6dd37
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-27 01:45:48.950 +04:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-06-27 01:45:48.952 +04:00 [INF] Executed action App.Controllers.Admin.CityController.Create (App) in 53.5717ms
2024-06-27 01:45:48.953 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.Create (App)'
2024-06-27 01:45:48.954 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7172/api/admin/City/Create application/json 59 - 500 - application/json;+charset=utf-8 61.6362ms
2024-06-27 01:45:52.511 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7172/api/admin/City/Create application/json 84
2024-06-27 01:45:52.513 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.Create (App)'
2024-06-27 01:45:52.514 +04:00 [INF] Route matched with {action = "Create", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Service.DTOs.Admin.Cities.CityCreateDto) on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:45:52.519 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:45:52.524 +04:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cities] ([CountryId], [CreatedData], [Name], [Population], [SoftDelete])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Cities]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2024-06-27 01:45:52.528 +04:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Cities_Countries_CountryId". The conflict occurred in database "AppBP101HomeTaskDb", table "dbo.Countries", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__189_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d25069bb-40f8-4853-b992-979acde6dd37
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Cities_Countries_CountryId". The conflict occurred in database "AppBP101HomeTaskDb", table "dbo.Countries", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__189_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d25069bb-40f8-4853-b992-979acde6dd37
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-27 01:45:52.550 +04:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-06-27 01:45:52.551 +04:00 [INF] Executed action App.Controllers.Admin.CityController.Create (App) in 32.6014ms
2024-06-27 01:45:52.555 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.Create (App)'
2024-06-27 01:45:52.556 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7172/api/admin/City/Create application/json 84 - 500 - application/json;+charset=utf-8 44.8416ms
2024-06-27 01:45:59.900 +04:00 [INF] Request starting HTTP/2 DELETE https://localhost:7172/api/admin/City/Delete/3333 - -
2024-06-27 01:45:59.902 +04:00 [INF] Executing endpoint 'App.Controllers.Admin.CityController.Delete (App)'
2024-06-27 01:45:59.909 +04:00 [INF] Route matched with {action = "Delete", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller App.Controllers.Admin.CityController (App).
2024-06-27 01:45:59.916 +04:00 [INF] Entity Framework Core 6.0.31 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.31' with options: None
2024-06-27 01:45:59.922 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[CountryId], [c].[CreatedData], [c].[Name], [c].[Population], [c].[SoftDelete]
FROM [Cities] AS [c]
WHERE [c].[Id] = @__id_0
2024-06-27 01:45:59.930 +04:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-06-27 01:45:59.933 +04:00 [INF] Executed action App.Controllers.Admin.CityController.Delete (App) in 16.8065ms
2024-06-27 01:45:59.935 +04:00 [INF] Executed endpoint 'App.Controllers.Admin.CityController.Delete (App)'
2024-06-27 01:45:59.936 +04:00 [INF] Request finished HTTP/2 DELETE https://localhost:7172/api/admin/City/Delete/3333 - - - 500 - application/json;+charset=utf-8 35.8932ms
